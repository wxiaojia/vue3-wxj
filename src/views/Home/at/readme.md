# @功能

+ 业内实现
微博的实现：就是通过正则匹配，最后用空格表示匹配结束，所以实现上是直接使用了textarea标签。但是这个实现必须依赖的一个事情是：用户名必须唯一。微博的用户名就是唯一的，所以正则所匹配到的ID，一般的可以映射到唯一的一个用户上（除非ID不存在）。整体的输出比较宽松，你可以构造任何不存在的ID进行@操作。

Twitter 的实现跟微博类似，也是以@开始，空格结尾做匹配。但是使用的是 contenteditable 这个属性进行富文本操作，相似之处在于 Twitter 的 ID 也是唯一，但是可以通过昵称进行搜索，然后转化成 ID，这一点在体验上好了不少。

+ 基本思路
1、监听用户输入，匹配用户以@开头的文字。
2、调用搜索弹窗，展示搜索出来的用户列表。
3、监听上、下、回车键控制列表选择，监听ESC键关闭搜索弹窗。
4、选择需要@的用户，把对应的HTML文本替换到原文本上。在HTML文本上添加用户的元数据。
一般来说，如果像平常用的 Lark 搜索，我们是不会通过唯一的『工号』去进行搜索，而是通过名字，但是名字会出现重复，所以就不太适合用textarea的方式，而是用contenteditable，把@文本替换成HTML标签特殊化标记。

+ 关键步骤


